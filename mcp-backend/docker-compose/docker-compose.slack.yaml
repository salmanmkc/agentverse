# ============================================================================
# AUTO-GENERATED FILE - DO NOT EDIT DIRECTLY
# ============================================================================
# Generated by: scripts/generate-docker-compose.py
# Mode: PROD (with container images)
# Personas: slack
# Transports: a2a-p2p, a2a-over-slim
#
# To regenerate this file, run:
#   make generate-docker-compose PERSONAS="slack"
#
# Or manually:
#   ./scripts/generate-docker-compose.py --persona slack
#
# Usage:
#   docker compose -f docker-compose/docker-compose.slack.yaml --profile a2a-p2p up         # A2A peer-to-peer transport
#   docker compose -f docker-compose/docker-compose.slack.yaml --profile a2a-over-slim up   # A2A over SLIM transport
# ============================================================================

services:
  caipe-slack-p2p:
    image: ghcr.io/cnoe-io/ai-platform-engineering:${IMAGE_TAG:-stable}
    container_name: caipe-slack-p2p
    volumes:
    - ../charts/ai-platform-engineering/data/prompt_config.yaml:/app/prompt_config.yaml
    - ../persona.yaml:/app/persona.yaml
    env_file:
    - ../.env
    ports:
    - 8000:8000
    environment:
    - A2A_TRANSPORT=p2p
    - SLACK_AGENT_HOST=agent-slack-slack-p2p
    - ENABLE_ARGOCD=false
    - ENABLE_AWS=false
    - ENABLE_BACKSTAGE=false
    - ENABLE_CONFLUENCE=false
    - ENABLE_GITHUB=false
    - ENABLE_JIRA=false
    - ENABLE_KOMODOR=false
    - ENABLE_PAGERDUTY=false
    - ENABLE_SLACK=true
    - ENABLE_SPLUNK=false
    - ENABLE_WEATHER_AGENT=false
    - ENABLE_WEBEX_AGENT=false
    - ENABLE_PETSTORE_AGENT=false
    - ENABLE_RAG=false
    depends_on:
    - agent-slack-slack-p2p
    command: platform-engineer
    profiles:
    - a2a-p2p
  agent-slack-slack-p2p:
    image: ghcr.io/cnoe-io/agent-slack:${IMAGE_TAG:-stable}
    container_name: agent-slack-slack-p2p
    env_file:
    - ../.env
    ports:
    - 8001:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-slack
    - MCP_PORT=8000
    depends_on:
    - mcp-slack
    profiles:
    - a2a-p2p
  mcp-slack:
    image: ghcr.io/cnoe-io/mcp-slack:${IMAGE_TAG:-stable}
    container_name: mcp-slack
    env_file:
    - ../.env
    ports:
    - 18026:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    profiles:
    - a2a-p2p
    - a2a-over-slim
  caipe-slack-slim:
    image: ghcr.io/cnoe-io/ai-platform-engineering:${IMAGE_TAG:-stable}
    container_name: caipe-slack-slim
    volumes:
    - ../charts/ai-platform-engineering/data/prompt_config.yaml:/app/prompt_config.yaml
    - ../persona.yaml:/app/persona.yaml
    env_file:
    - ../.env
    ports:
    - 8000:8000
    environment:
    - A2A_TRANSPORT=slim
    - SLACK_AGENT_HOST=agent-slack-slack-slim
    - ENABLE_ARGOCD=false
    - ENABLE_AWS=false
    - ENABLE_BACKSTAGE=false
    - ENABLE_CONFLUENCE=false
    - ENABLE_GITHUB=false
    - ENABLE_JIRA=false
    - ENABLE_KOMODOR=false
    - ENABLE_PAGERDUTY=false
    - ENABLE_SLACK=true
    - ENABLE_SPLUNK=false
    - ENABLE_WEATHER_AGENT=false
    - ENABLE_WEBEX_AGENT=false
    - ENABLE_PETSTORE_AGENT=false
    - ENABLE_RAG=false
    depends_on:
    - agent-slack-slack-slim
    - slim-dataplane
    - slim-control-plane
    command: platform-engineer
    profiles:
    - a2a-over-slim
  agent-slack-slack-slim:
    image: ghcr.io/cnoe-io/agent-slack:${IMAGE_TAG:-stable}
    container_name: agent-slack-slack-slim
    env_file:
    - ../.env
    ports:
    - 8001:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-slack
    - MCP_PORT=8000
    depends_on:
    - mcp-slack
    - slim-dataplane
    profiles:
    - a2a-over-slim
  slim-dataplane:
    image: ghcr.io/agntcy/slim:0.3.15
    container_name: slim-dataplane
    profiles:
    - a2a-over-slim
    ports:
    - 46357:46357
    environment:
    - PASSWORD=${SLIM_GATEWAY_PASSWORD:-dummy_password}
    - CONFIG_PATH=/config.yaml
    volumes:
    - ../slim-config.yaml:/config.yaml
    command:
    - /slim
    - --config
    - /config.yaml
  slim-control-plane:
    image: ghcr.io/agntcy/slim/control-plane:0.0.1
    container_name: slim-control-plane
    profiles:
    - a2a-over-slim
    ports:
    - 50051:50051
    - 50052:50052
    environment:
    - PASSWORD=${SLIM_GATEWAY_PASSWORD:-dummy_password}
    - CONFIG_PATH=/config.yaml
    volumes:
    - ../slim-config.yaml:/config.yaml
    command:
    - /slim
    - --config
    - /config.yaml
