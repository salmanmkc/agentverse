# ============================================================================
# AUTO-GENERATED FILE - DO NOT EDIT DIRECTLY
# ============================================================================
# Generated by: scripts/generate-docker-compose.py
# Mode: DEV (with local code mounts)
# Personas: caipe-complete-with-tracing
# Transports: a2a-p2p, a2a-over-slim
#
# To regenerate this file, run:
#   make generate-docker-compose PERSONAS="caipe-complete-with-tracing" DEV=true
#
# Or manually:
#   ./scripts/generate-docker-compose.py --persona caipe-complete-with-tracing --dev
#
# Usage:
#   docker compose -f docker-compose/docker-compose.caipe-complete-with-tracing.dev.yaml --profile a2a-p2p up         # A2A peer-to-peer transport
#   docker compose -f docker-compose/docker-compose.caipe-complete-with-tracing.dev.yaml --profile a2a-over-slim up   # A2A over SLIM transport
# ============================================================================

services:
  caipe-caipe-complete-with-tracing-p2p:
    container_name: caipe-caipe-complete-with-tracing-p2p
    volumes:
    - ../charts/ai-platform-engineering/data/prompt_config.deep_agent.yaml:/app/prompt_config.yaml
    - ../persona.yaml:/app/persona.yaml
    - ../ai_platform_engineering:/app/ai_platform_engineering
    env_file:
    - ../.env
    ports:
    - 8000:8000
    environment:
    - AGENT_CONNECTIVITY_ENABLE_BACKGROUND=true # Routinely checks each subagent connectivity to add or remove any from existing tools list.
    - AGENT_PROTOCOL=a2a # Use A2A protocol for agent-to-agent communication.
    - SKIP_AGENT_CONNECTIVITY_CHECK=false # Do not skip the connectivity check; supervisor agent will check each subagent is reachable and only add reachable tools.
    - A2A_TRANSPORT=p2p
    - ARGOCD_AGENT_HOST=agent-argocd-caipe-complete-with-tracing-p2p
    - AWS_AGENT_HOST=agent-aws-caipe-complete-with-tracing-p2p
    - BACKSTAGE_AGENT_HOST=agent-backstage-caipe-complete-with-tracing-p2p
    - CONFLUENCE_AGENT_HOST=agent-confluence-caipe-complete-with-tracing-p2p
    - GITHUB_AGENT_HOST=agent-github-caipe-complete-with-tracing-p2p
    - JIRA_AGENT_HOST=agent-jira-caipe-complete-with-tracing-p2p
    - KOMODOR_AGENT_HOST=agent-komodor-caipe-complete-with-tracing-p2p
    - PAGERDUTY_AGENT_HOST=agent-pagerduty-caipe-complete-with-tracing-p2p
    - SLACK_AGENT_HOST=agent-slack-caipe-complete-with-tracing-p2p
    - SPLUNK_AGENT_HOST=agent-splunk-caipe-complete-with-tracing-p2p
    - WEATHER_AGENT_HOST=agent-weather-caipe-complete-with-tracing-p2p
    - WEBEX_AGENT_HOST=agent-webex-caipe-complete-with-tracing-p2p
    - PETSTORE_AGENT_HOST=agent-petstore-caipe-complete-with-tracing-p2p
    - ENABLE_ARGOCD=true
    - ENABLE_AWS=true
    - ENABLE_BACKSTAGE=true
    - ENABLE_CONFLUENCE=true
    - ENABLE_GITHUB=true
    - ENABLE_JIRA=true
    - ENABLE_KOMODOR=true
    - ENABLE_PAGERDUTY=true
    - ENABLE_SLACK=true
    - ENABLE_SPLUNK=true
    - ENABLE_WEATHER_AGENT=true
    - ENABLE_WEBEX_AGENT=true
    - ENABLE_PETSTORE_AGENT=true
    - ENABLE_RAG=false
    depends_on:
    - agent-argocd-caipe-complete-with-tracing-p2p
    - agent-aws-caipe-complete-with-tracing-p2p
    - agent-backstage-caipe-complete-with-tracing-p2p
    - agent-confluence-caipe-complete-with-tracing-p2p
    - agent-github-caipe-complete-with-tracing-p2p
    - agent-jira-caipe-complete-with-tracing-p2p
    - agent-komodor-caipe-complete-with-tracing-p2p
    - agent-pagerduty-caipe-complete-with-tracing-p2p
    - agent-slack-caipe-complete-with-tracing-p2p
    - agent-splunk-caipe-complete-with-tracing-p2p
    - agent-weather-caipe-complete-with-tracing-p2p
    - agent-webex-caipe-complete-with-tracing-p2p
    - agent-petstore-caipe-complete-with-tracing-p2p
    command: platform-engineer
    build:
      context: ..
      dockerfile: build/Dockerfile
    profiles:
    - a2a-p2p
  agent-argocd-caipe-complete-with-tracing-p2p:
    container_name: agent-argocd-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8001:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-argocd
    - MCP_PORT=8000
    depends_on:
    - mcp-argocd
    volumes:
    - ../ai_platform_engineering/agents/argocd:/app/ai_platform_engineering/agents/argocd
    build:
      context: ../ai_platform_engineering/agents/argocd
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-argocd:
    container_name: mcp-argocd
    env_file:
    - ../.env
    ports:
    - 18024:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/argocd/mcp/mcp_argocd:/app/mcp_argocd
    build:
      context: ../ai_platform_engineering/agents/argocd
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-aws-caipe-complete-with-tracing-p2p:
    container_name: agent-aws-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8002:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-aws
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/aws:/app/ai_platform_engineering/agents/aws
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/aws/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  # No mcp-aws as aws only supports stdio transport currently.
  agent-backstage-caipe-complete-with-tracing-p2p:
    container_name: agent-backstage-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8003:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-backstage
    - MCP_PORT=8000
    depends_on:
    - mcp-backstage
    volumes:
    - ../ai_platform_engineering/agents/backstage:/app/ai_platform_engineering/agents/backstage
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/backstage/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-backstage:
    container_name: mcp-backstage
    env_file:
    - ../.env
    ports:
    - 18033:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/backstage/mcp/mcp_backstage:/app/mcp_backstage
    build:
      context: ../ai_platform_engineering/agents/backstage
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-confluence-caipe-complete-with-tracing-p2p:
    container_name: agent-confluence-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8004:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-confluence
    - MCP_PORT=8000
    depends_on:
    - mcp-confluence
    volumes:
    - ../ai_platform_engineering/agents/confluence:/app/ai_platform_engineering/agents/confluence
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/confluence/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-confluence:
    container_name: mcp-confluence
    env_file:
    - ../.env
    ports:
    - 18058:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/confluence/mcp/mcp_confluence:/app/mcp_confluence
    build:
      context: ../ai_platform_engineering/agents/confluence
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-github-caipe-complete-with-tracing-p2p:
    container_name: agent-github-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8005:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-github
    - MCP_PORT=8000
    depends_on: []
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    - ../ai_platform_engineering/agents/github:/app/ai_platform_engineering/agents/github
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/github/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  agent-jira-caipe-complete-with-tracing-p2p:
    container_name: agent-jira-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8006:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-jira
    - MCP_PORT=8000
    depends_on:
    - mcp-jira
    volumes:
    - ../ai_platform_engineering/agents/jira:/app/ai_platform_engineering/agents/jira
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/jira/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-jira:
    container_name: mcp-jira
    env_file:
    - ../.env
    ports:
    - 18022:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/jira/mcp/mcp_jira:/app/mcp_jira
    build:
      context: ../ai_platform_engineering/agents/jira
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-komodor-caipe-complete-with-tracing-p2p:
    container_name: agent-komodor-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8007:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-komodor
    - MCP_PORT=8000
    depends_on:
    - mcp-komodor
    volumes:
    - ../ai_platform_engineering/agents/komodor:/app/ai_platform_engineering/agents/komodor
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/komodor/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-komodor:
    container_name: mcp-komodor
    env_file:
    - ../.env
    ports:
    - 18063:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/komodor/mcp/mcp_komodor:/app/mcp_komodor
    build:
      context: ../ai_platform_engineering/agents/komodor
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-pagerduty-caipe-complete-with-tracing-p2p:
    container_name: agent-pagerduty-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8008:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-pagerduty
    - MCP_PORT=8000
    depends_on:
    - mcp-pagerduty
    volumes:
    - ../ai_platform_engineering/agents/pagerduty:/app/ai_platform_engineering/agents/pagerduty
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/pagerduty/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-pagerduty:
    container_name: mcp-pagerduty
    env_file:
    - ../.env
    ports:
    - 18081:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/pagerduty/mcp/mcp_pagerduty:/app/mcp_pagerduty
    build:
      context: ../ai_platform_engineering/agents/pagerduty
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-slack-caipe-complete-with-tracing-p2p:
    container_name: agent-slack-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8009:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-slack
    - MCP_PORT=8000
    depends_on:
    - mcp-slack
    volumes:
    - ../ai_platform_engineering/agents/slack:/app/ai_platform_engineering/agents/slack
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/slack/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-slack:
    container_name: mcp-slack
    env_file:
    - ../.env
    ports:
    - 18026:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/slack/mcp/mcp_slack:/app/mcp_slack
    build:
      context: ../ai_platform_engineering/agents/slack
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-splunk-caipe-complete-with-tracing-p2p:
    container_name: agent-splunk-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8010:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-splunk
    - MCP_PORT=8000
    depends_on:
    - mcp-splunk
    volumes:
    - ../ai_platform_engineering/agents/splunk:/app/ai_platform_engineering/agents/splunk
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/splunk/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-splunk:
    container_name: mcp-splunk
    env_file:
    - ../.env
    ports:
    - 18069:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/splunk/mcp/mcp_splunk:/app/mcp_splunk
    build:
      context: ../ai_platform_engineering/agents/splunk
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-weather-caipe-complete-with-tracing-p2p:
    container_name: agent-weather-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8011:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=weather.outshift.io
    - MCP_PORT=443
    depends_on: []
    volumes:
    - ../ai_platform_engineering/agents/weather:/app/ai_platform_engineering/agents/weather
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/weather/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  agent-webex-caipe-complete-with-tracing-p2p:
    container_name: agent-webex-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8012:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-webex
    - MCP_PORT=8000
    depends_on:
    - mcp-webex
    volumes:
    - ../ai_platform_engineering/agents/webex:/app/ai_platform_engineering/agents/webex
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/webex/build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  mcp-webex:
    container_name: mcp-webex
    env_file:
    - ../.env
    ports:
    - 18039:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    volumes:
    - ../ai_platform_engineering/agents/webex/mcp/mcp_webex:/app/mcp_webex
    build:
      context: ../ai_platform_engineering/agents/webex
      dockerfile: build/Dockerfile.mcp
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-petstore-caipe-complete-with-tracing-p2p:
    container_name: agent-petstore-caipe-complete-with-tracing-p2p
    env_file:
    - ../.env
    ports:
    - 8013:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=petstore.outshift.io
    - MCP_PORT=443
    depends_on: []
    volumes:
    - ../ai_platform_engineering/agents/template:/app/ai_platform_engineering/agents/template
    build:
      context: ../ai_platform_engineering/agents/template
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-p2p
  caipe-caipe-complete-with-tracing-slim:
    container_name: caipe-caipe-complete-with-tracing-slim
    volumes:
    - ../charts/ai-platform-engineering/data/prompt_config.yaml:/app/prompt_config.yaml
    - ../persona.yaml:/app/persona.yaml
    - ../ai_platform_engineering:/app/ai_platform_engineering
    env_file:
    - ../.env
    ports:
    - 8000:8000
    environment:
    - A2A_TRANSPORT=slim
    - ARGOCD_AGENT_HOST=agent-argocd-caipe-complete-with-tracing-slim
    - AWS_AGENT_HOST=agent-aws-caipe-complete-with-tracing-slim
    - BACKSTAGE_AGENT_HOST=agent-backstage-caipe-complete-with-tracing-slim
    - CONFLUENCE_AGENT_HOST=agent-confluence-caipe-complete-with-tracing-slim
    - GITHUB_AGENT_HOST=agent-github-caipe-complete-with-tracing-slim
    - JIRA_AGENT_HOST=agent-jira-caipe-complete-with-tracing-slim
    - KOMODOR_AGENT_HOST=agent-komodor-caipe-complete-with-tracing-slim
    - PAGERDUTY_AGENT_HOST=agent-pagerduty-caipe-complete-with-tracing-slim
    - SLACK_AGENT_HOST=agent-slack-caipe-complete-with-tracing-slim
    - SPLUNK_AGENT_HOST=agent-splunk-caipe-complete-with-tracing-slim
    - WEATHER_AGENT_HOST=agent-weather-caipe-complete-with-tracing-slim
    - WEBEX_AGENT_HOST=agent-webex-caipe-complete-with-tracing-slim
    - PETSTORE_AGENT_HOST=agent-petstore-caipe-complete-with-tracing-slim
    - ENABLE_ARGOCD=true
    - ENABLE_AWS=true
    - ENABLE_BACKSTAGE=true
    - ENABLE_CONFLUENCE=true
    - ENABLE_GITHUB=true
    - ENABLE_JIRA=true
    - ENABLE_KOMODOR=true
    - ENABLE_PAGERDUTY=true
    - ENABLE_SLACK=true
    - ENABLE_SPLUNK=true
    - ENABLE_WEATHER_AGENT=true
    - ENABLE_WEBEX_AGENT=true
    - ENABLE_PETSTORE_AGENT=true
    - ENABLE_RAG=false
    depends_on:
    - agent-argocd-caipe-complete-with-tracing-slim
    - agent-aws-caipe-complete-with-tracing-slim
    - agent-backstage-caipe-complete-with-tracing-slim
    - agent-confluence-caipe-complete-with-tracing-slim
    - agent-github-caipe-complete-with-tracing-slim
    - agent-jira-caipe-complete-with-tracing-slim
    - agent-komodor-caipe-complete-with-tracing-slim
    - agent-pagerduty-caipe-complete-with-tracing-slim
    - agent-slack-caipe-complete-with-tracing-slim
    - agent-splunk-caipe-complete-with-tracing-slim
    - agent-weather-caipe-complete-with-tracing-slim
    - agent-webex-caipe-complete-with-tracing-slim
    - agent-petstore-caipe-complete-with-tracing-slim
    - slim-dataplane
    - slim-control-plane
    command: platform-engineer
    build:
      context: ..
      dockerfile: build/Dockerfile
    profiles:
    - a2a-over-slim
  agent-argocd-caipe-complete-with-tracing-slim:
    container_name: agent-argocd-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8001:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-argocd
    - MCP_PORT=8000
    depends_on:
    - mcp-argocd
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/argocd:/app/ai_platform_engineering/agents/argocd
    build:
      context: ../ai_platform_engineering/agents/argocd
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-aws-caipe-complete-with-tracing-slim:
    container_name: agent-aws-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8002:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-aws
    - MCP_PORT=8000
    depends_on:
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/aws:/app/ai_platform_engineering/agents/aws
    build:
      context: ../ai_platform_engineering/agents/aws
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-backstage-caipe-complete-with-tracing-slim:
    container_name: agent-backstage-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8003:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-backstage
    - MCP_PORT=8000
    depends_on:
    - mcp-backstage
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/backstage:/app/ai_platform_engineering/agents/backstage
    build:
      context: ../ai_platform_engineering/agents/backstage
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-confluence-caipe-complete-with-tracing-slim:
    container_name: agent-confluence-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8004:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-confluence
    - MCP_PORT=8000
    depends_on:
    - mcp-confluence
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/confluence:/app/ai_platform_engineering/agents/confluence
    build:
      context: ../ai_platform_engineering/agents/confluence
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-github-caipe-complete-with-tracing-slim:
    container_name: agent-github-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8005:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-github
    - MCP_PORT=8000
    depends_on:
    - slim-dataplane
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    - ../ai_platform_engineering/agents/github:/app/ai_platform_engineering/agents/github
    build:
      context: ../ai_platform_engineering/agents/github
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-jira-caipe-complete-with-tracing-slim:
    container_name: agent-jira-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8006:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-jira
    - MCP_PORT=8000
    depends_on:
    - mcp-jira
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/jira:/app/ai_platform_engineering/agents/jira
    build:
      context: ../ai_platform_engineering/agents/jira
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-komodor-caipe-complete-with-tracing-slim:
    container_name: agent-komodor-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8007:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-komodor
    - MCP_PORT=8000
    depends_on:
    - mcp-komodor
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/komodor:/app/ai_platform_engineering/agents/komodor
    build:
      context: ../ai_platform_engineering/agents/komodor
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-pagerduty-caipe-complete-with-tracing-slim:
    container_name: agent-pagerduty-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8008:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-pagerduty
    - MCP_PORT=8000
    depends_on:
    - mcp-pagerduty
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/pagerduty:/app/ai_platform_engineering/agents/pagerduty
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/pagerduty/build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-slack-caipe-complete-with-tracing-slim:
    container_name: agent-slack-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8009:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-slack
    - MCP_PORT=8000
    depends_on:
    - mcp-slack
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/slack:/app/ai_platform_engineering/agents/slack
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/slack/build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-splunk-caipe-complete-with-tracing-slim:
    container_name: agent-splunk-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8010:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-splunk
    - MCP_PORT=8000
    depends_on:
    - mcp-splunk
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/splunk:/app/ai_platform_engineering/agents/splunk
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/splunk/build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-weather-caipe-complete-with-tracing-slim:
    container_name: agent-weather-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8011:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=weather.outshift.io
    - MCP_PORT=443
    depends_on:
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/weather:/app/ai_platform_engineering/agents/weather
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/weather/build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-webex-caipe-complete-with-tracing-slim:
    container_name: agent-webex-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8012:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-webex
    - MCP_PORT=8000
    depends_on:
    - mcp-webex
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/webex:/app/ai_platform_engineering/agents/webex
    build:
      context: ../ai_platform_engineering
      dockerfile: agents/webex/build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  agent-petstore-caipe-complete-with-tracing-slim:
    container_name: agent-petstore-caipe-complete-with-tracing-slim
    env_file:
    - ../.env
    ports:
    - 8013:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=petstore.outshift.io
    - MCP_PORT=443
    depends_on:
    - slim-dataplane
    volumes:
    - ../ai_platform_engineering/agents/template:/app/ai_platform_engineering/agents/template
    build:
      context: ../ai_platform_engineering/agents/template
      dockerfile: build/Dockerfile.a2a
    profiles:
    - a2a-over-slim
  slim-dataplane:
    image: ghcr.io/agntcy/slim:0.3.15
    container_name: slim-dataplane
    profiles:
    - a2a-over-slim
    ports:
    - 46357:46357
    environment:
    - PASSWORD=${SLIM_GATEWAY_PASSWORD:-dummy_password}
    - CONFIG_PATH=/config.yaml
    volumes:
    - ../slim-config.yaml:/config.yaml
    command:
    - /slim
    - --config
    - /config.yaml
  slim-control-plane:
    image: ghcr.io/agntcy/slim/control-plane:0.0.1
    container_name: slim-control-plane
    profiles:
    - a2a-over-slim
    ports:
    - 50051:50051
    - 50052:50052
    environment:
    - PASSWORD=${SLIM_GATEWAY_PASSWORD:-dummy_password}
    - CONFIG_PATH=/config.yaml
    volumes:
    - ../slim-config.yaml:/config.yaml
    command:
    - /slim
    - --config
    - /config.yaml
  langfuse-worker:
    image: langfuse/langfuse-worker:3
    container_name: langfuse-worker
    restart: always
    depends_on:
      langfuse-postgres:
        condition: service_healthy
      langfuse-minio:
        condition: service_healthy
      langfuse-redis:
        condition: service_healthy
      langfuse-clickhouse:
        condition: service_healthy
    ports:
    - 127.0.0.1:3030:3030
    environment:
    - DATABASE_URL=postgresql://postgres:postgres@langfuse-postgres:5432/postgres
    - SALT=mysalt
    - ENCRYPTION_KEY=0000000000000000000000000000000000000000000000000000000000000000
    - CLICKHOUSE_MIGRATION_URL=clickhouse://langfuse-clickhouse:9000
    - CLICKHOUSE_URL=http://langfuse-clickhouse:8123
    - CLICKHOUSE_USER=clickhouse
    - CLICKHOUSE_PASSWORD=clickhouse
    - CLICKHOUSE_CLUSTER_ENABLED=false
    - LANGFUSE_S3_EVENT_UPLOAD_BUCKET=langfuse
    - LANGFUSE_S3_EVENT_UPLOAD_REGION=us-east-1
    - LANGFUSE_S3_EVENT_UPLOAD_ACCESS_KEY_ID=minio
    - LANGFUSE_S3_EVENT_UPLOAD_SECRET_ACCESS_KEY=miniosecret
    - LANGFUSE_S3_EVENT_UPLOAD_ENDPOINT=http://langfuse-minio:9000
    - LANGFUSE_S3_EVENT_UPLOAD_FORCE_PATH_STYLE=true
    - LANGFUSE_S3_EVENT_UPLOAD_PREFIX=events/
    - LANGFUSE_S3_MEDIA_UPLOAD_BUCKET=langfuse
    - LANGFUSE_S3_MEDIA_UPLOAD_REGION=us-east-1
    - LANGFUSE_S3_MEDIA_UPLOAD_ACCESS_KEY_ID=minio
    - LANGFUSE_S3_MEDIA_UPLOAD_SECRET_ACCESS_KEY=miniosecret
    - LANGFUSE_S3_MEDIA_UPLOAD_ENDPOINT=http://langfuse-minio:9000
    - LANGFUSE_S3_MEDIA_UPLOAD_FORCE_PATH_STYLE=true
    - LANGFUSE_S3_MEDIA_UPLOAD_PREFIX=media/
    - REDIS_HOST=langfuse-redis
    - REDIS_AUTH=myredissecret
  langfuse-web:
    image: langfuse/langfuse:3
    container_name: langfuse-web
    restart: always
    depends_on:
      langfuse-postgres:
        condition: service_healthy
      langfuse-minio:
        condition: service_healthy
      langfuse-redis:
        condition: service_healthy
      langfuse-clickhouse:
        condition: service_healthy
    ports:
    - 3000:3000
    environment:
    - DATABASE_URL=postgresql://postgres:postgres@langfuse-postgres:5432/postgres
    - SALT=mysalt
    - ENCRYPTION_KEY=0000000000000000000000000000000000000000000000000000000000000000
    - CLICKHOUSE_MIGRATION_URL=clickhouse://langfuse-clickhouse:9000
    - CLICKHOUSE_URL=http://langfuse-clickhouse:8123
    - CLICKHOUSE_USER=clickhouse
    - HOSTNAME=0.0.0.0
    - CLICKHOUSE_PASSWORD=clickhouse
    - CLICKHOUSE_CLUSTER_ENABLED=false
    - LANGFUSE_S3_EVENT_UPLOAD_BUCKET=langfuse
    - LANGFUSE_S3_EVENT_UPLOAD_REGION=us-east-1
    - LANGFUSE_S3_EVENT_UPLOAD_ACCESS_KEY_ID=minio
    - LANGFUSE_S3_EVENT_UPLOAD_SECRET_ACCESS_KEY=miniosecret
    - LANGFUSE_S3_EVENT_UPLOAD_ENDPOINT=http://langfuse-minio:9000
    - LANGFUSE_S3_EVENT_UPLOAD_FORCE_PATH_STYLE=true
    - LANGFUSE_S3_EVENT_UPLOAD_PREFIX=events/
    - LANGFUSE_S3_MEDIA_UPLOAD_BUCKET=langfuse
    - LANGFUSE_S3_MEDIA_UPLOAD_REGION=us-east-1
    - LANGFUSE_S3_MEDIA_UPLOAD_ACCESS_KEY_ID=minio
    - LANGFUSE_S3_MEDIA_UPLOAD_SECRET_ACCESS_KEY=miniosecret
    - LANGFUSE_S3_MEDIA_UPLOAD_ENDPOINT=http://langfuse-minio:9000
    - LANGFUSE_S3_MEDIA_UPLOAD_FORCE_PATH_STYLE=true
    - LANGFUSE_S3_MEDIA_UPLOAD_PREFIX=media/
    - REDIS_HOST=langfuse-redis
    - REDIS_AUTH=myredissecret
    - NEXTAUTH_URL=http://localhost:3000
    - NEXTAUTH_SECRET=mysecret
  langfuse-clickhouse:
    image: clickhouse/clickhouse-server
    container_name: langfuse-clickhouse
    restart: always
    user: 101:101
    environment:
      CLICKHOUSE_DB: default
      CLICKHOUSE_USER: clickhouse
      CLICKHOUSE_PASSWORD: clickhouse
    volumes:
    - langfuse_clickhouse_data:/var/lib/clickhouse
    - langfuse_clickhouse_logs:/var/log/clickhouse-server
    ports:
    - 127.0.0.1:8123:8123
    - 127.0.0.1:9000:9000
    healthcheck:
      test: wget --no-verbose --tries=1 --spider http://localhost:8123/ping || exit
        1
      interval: 5s
      timeout: 5s
      retries: 10
      start_period: 1s
  langfuse-minio:
    image: minio/minio
    container_name: langfuse-minio
    restart: always
    entrypoint: sh
    command: -c 'mkdir -p /data/langfuse && minio server --address ":9000" --console-address
      ":9001" /data'
    environment:
      MINIO_ROOT_USER: minio
      MINIO_ROOT_PASSWORD: miniosecret
    ports:
    - 9090:9000
    - 127.0.0.1:9091:9001
    volumes:
    - langfuse_minio_data:/data
    healthcheck:
      test:
      - CMD
      - mc
      - ready
      - local
      interval: 1s
      timeout: 5s
      retries: 5
      start_period: 1s
  langfuse-redis:
    image: redis:7
    container_name: langfuse-redis
    restart: always
    command: --requirepass ${REDIS_AUTH:-myredissecret}
    ports:
    - 127.0.0.1:6379:6379
    healthcheck:
      test:
      - CMD
      - redis-cli
      - ping
      interval: 3s
      timeout: 10s
      retries: 10
  langfuse-postgres:
    image: postgres:15
    container_name: langfuse-postgres
    restart: always
    healthcheck:
      test:
      - CMD-SHELL
      - pg_isready -U postgres
      interval: 3s
      timeout: 3s
      retries: 10
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: postgres
    ports:
    - 127.0.0.1:15432:5432 # 5432 is often taken in the local machine, so we use 15432 as a different port
    volumes:
    - langfuse_postgres_data:/var/lib/postgresql/data
volumes:
  langfuse_postgres_data:
    driver: local
  langfuse_clickhouse_data:
    driver: local
  langfuse_clickhouse_logs:
    driver: local
  langfuse_minio_data:
    driver: local
