# ============================================================================
# AUTO-GENERATED FILE - DO NOT EDIT DIRECTLY
# ============================================================================
# Generated by: scripts/generate-docker-compose.py
# Mode: PROD (with container images)
# Personas: incident-engineer
# Transports: a2a-p2p, a2a-over-slim
#
# To regenerate this file, run:
#   make generate-docker-compose PERSONAS="incident-engineer"
#
# Or manually:
#   ./scripts/generate-docker-compose.py --persona incident-engineer
#
# Usage:
#   docker compose -f docker-compose/docker-compose.incident-engineer.yaml --profile a2a-p2p up         # A2A peer-to-peer transport
#   docker compose -f docker-compose/docker-compose.incident-engineer.yaml --profile a2a-over-slim up   # A2A over SLIM transport
# ============================================================================

services:
  caipe-incident-engineer-p2p:
    image: ghcr.io/cnoe-io/ai-platform-engineering:${IMAGE_TAG:-stable}
    container_name: caipe-incident-engineer-p2p
    volumes:
    - ../charts/ai-platform-engineering/data/prompt_config.yaml:/app/prompt_config.yaml
    - ../persona.yaml:/app/persona.yaml
    env_file:
    - ../.env
    ports:
    - 8000:8000
    environment:
    - A2A_TRANSPORT=p2p
    - PAGERDUTY_AGENT_HOST=agent-pagerduty-incident-engineer-p2p
    - GITHUB_AGENT_HOST=agent-github-incident-engineer-p2p
    - BACKSTAGE_AGENT_HOST=agent-backstage-incident-engineer-p2p
    - JIRA_AGENT_HOST=agent-jira-incident-engineer-p2p
    - CONFLUENCE_AGENT_HOST=agent-confluence-incident-engineer-p2p
    - KOMODOR_AGENT_HOST=agent-komodor-incident-engineer-p2p
    - ENABLE_ARGOCD=false
    - ENABLE_AWS=false
    - ENABLE_BACKSTAGE=true
    - ENABLE_CONFLUENCE=true
    - ENABLE_GITHUB=true
    - ENABLE_JIRA=true
    - ENABLE_KOMODOR=true
    - ENABLE_PAGERDUTY=true
    - ENABLE_SLACK=false
    - ENABLE_SPLUNK=false
    - ENABLE_WEATHER_AGENT=false
    - ENABLE_WEBEX_AGENT=false
    - ENABLE_PETSTORE_AGENT=false
    - ENABLE_RAG=false
    depends_on:
    - agent-pagerduty-incident-engineer-p2p
    - agent-github-incident-engineer-p2p
    - agent-backstage-incident-engineer-p2p
    - agent-jira-incident-engineer-p2p
    - agent-confluence-incident-engineer-p2p
    - agent-komodor-incident-engineer-p2p
    command: platform-engineer
    profiles:
    - a2a-p2p
  agent-pagerduty-incident-engineer-p2p:
    image: ghcr.io/cnoe-io/agent-pagerduty:${IMAGE_TAG:-stable}
    container_name: agent-pagerduty-incident-engineer-p2p
    env_file:
    - ../.env
    ports:
    - 8001:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-pagerduty
    - MCP_PORT=8000
    depends_on:
    - mcp-pagerduty
    profiles:
    - a2a-p2p
  mcp-pagerduty:
    image: ghcr.io/cnoe-io/mcp-pagerduty:${IMAGE_TAG:-stable}
    container_name: mcp-pagerduty
    env_file:
    - ../.env
    ports:
    - 18081:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-github-incident-engineer-p2p:
    image: ghcr.io/cnoe-io/agent-github:${IMAGE_TAG:-stable}
    container_name: agent-github-incident-engineer-p2p
    env_file:
    - ../.env
    ports:
    - 8002:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-github
    - MCP_PORT=8000
    depends_on: []
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    profiles:
    - a2a-p2p
  agent-backstage-incident-engineer-p2p:
    image: ghcr.io/cnoe-io/agent-backstage:${IMAGE_TAG:-stable}
    container_name: agent-backstage-incident-engineer-p2p
    env_file:
    - ../.env
    ports:
    - 8003:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-backstage
    - MCP_PORT=8000
    depends_on:
    - mcp-backstage
    profiles:
    - a2a-p2p
  mcp-backstage:
    image: ghcr.io/cnoe-io/mcp-backstage:${IMAGE_TAG:-stable}
    container_name: mcp-backstage
    env_file:
    - ../.env
    ports:
    - 18033:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-jira-incident-engineer-p2p:
    image: ghcr.io/cnoe-io/agent-jira:${IMAGE_TAG:-stable}
    container_name: agent-jira-incident-engineer-p2p
    env_file:
    - ../.env
    ports:
    - 8004:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-jira
    - MCP_PORT=8000
    depends_on:
    - mcp-jira
    profiles:
    - a2a-p2p
  mcp-jira:
    image: ghcr.io/cnoe-io/mcp-jira:${IMAGE_TAG:-stable}
    container_name: mcp-jira
    env_file:
    - ../.env
    ports:
    - 18022:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-confluence-incident-engineer-p2p:
    image: ghcr.io/cnoe-io/agent-confluence:${IMAGE_TAG:-stable}
    container_name: agent-confluence-incident-engineer-p2p
    env_file:
    - ../.env
    ports:
    - 8005:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-confluence
    - MCP_PORT=8000
    depends_on:
    - mcp-confluence
    profiles:
    - a2a-p2p
  mcp-confluence:
    image: ghcr.io/cnoe-io/mcp-confluence:${IMAGE_TAG:-stable}
    container_name: mcp-confluence
    env_file:
    - ../.env
    ports:
    - 18058:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    profiles:
    - a2a-p2p
    - a2a-over-slim
  agent-komodor-incident-engineer-p2p:
    image: ghcr.io/cnoe-io/agent-komodor:${IMAGE_TAG:-stable}
    container_name: agent-komodor-incident-engineer-p2p
    env_file:
    - ../.env
    ports:
    - 8006:8000
    environment:
    - A2A_TRANSPORT=p2p
    - MCP_MODE=http
    - MCP_HOST=mcp-komodor
    - MCP_PORT=8000
    depends_on:
    - mcp-komodor
    profiles:
    - a2a-p2p
  mcp-komodor:
    image: ghcr.io/cnoe-io/mcp-komodor:${IMAGE_TAG:-stable}
    container_name: mcp-komodor
    env_file:
    - ../.env
    ports:
    - 18063:8000
    environment:
    - MCP_MODE=http
    - MCP_HOST=0.0.0.0
    - MCP_PORT=8000
    profiles:
    - a2a-p2p
    - a2a-over-slim
  caipe-incident-engineer-slim:
    image: ghcr.io/cnoe-io/ai-platform-engineering:${IMAGE_TAG:-stable}
    container_name: caipe-incident-engineer-slim
    volumes:
    - ../charts/ai-platform-engineering/data/prompt_config.yaml:/app/prompt_config.yaml
    - ../persona.yaml:/app/persona.yaml
    env_file:
    - ../.env
    ports:
    - 8000:8000
    environment:
    - A2A_TRANSPORT=slim
    - PAGERDUTY_AGENT_HOST=agent-pagerduty-incident-engineer-slim
    - GITHUB_AGENT_HOST=agent-github-incident-engineer-slim
    - BACKSTAGE_AGENT_HOST=agent-backstage-incident-engineer-slim
    - JIRA_AGENT_HOST=agent-jira-incident-engineer-slim
    - CONFLUENCE_AGENT_HOST=agent-confluence-incident-engineer-slim
    - KOMODOR_AGENT_HOST=agent-komodor-incident-engineer-slim
    - ENABLE_ARGOCD=false
    - ENABLE_AWS=false
    - ENABLE_BACKSTAGE=true
    - ENABLE_CONFLUENCE=true
    - ENABLE_GITHUB=true
    - ENABLE_JIRA=true
    - ENABLE_KOMODOR=true
    - ENABLE_PAGERDUTY=true
    - ENABLE_SLACK=false
    - ENABLE_SPLUNK=false
    - ENABLE_WEATHER_AGENT=false
    - ENABLE_WEBEX_AGENT=false
    - ENABLE_PETSTORE_AGENT=false
    - ENABLE_RAG=false
    depends_on:
    - agent-pagerduty-incident-engineer-slim
    - agent-github-incident-engineer-slim
    - agent-backstage-incident-engineer-slim
    - agent-jira-incident-engineer-slim
    - agent-confluence-incident-engineer-slim
    - agent-komodor-incident-engineer-slim
    - slim-dataplane
    - slim-control-plane
    command: platform-engineer
    profiles:
    - a2a-over-slim
  agent-pagerduty-incident-engineer-slim:
    image: ghcr.io/cnoe-io/agent-pagerduty:${IMAGE_TAG:-stable}
    container_name: agent-pagerduty-incident-engineer-slim
    env_file:
    - ../.env
    ports:
    - 8001:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-pagerduty
    - MCP_PORT=8000
    depends_on:
    - mcp-pagerduty
    - slim-dataplane
    profiles:
    - a2a-over-slim
  agent-github-incident-engineer-slim:
    image: ghcr.io/cnoe-io/agent-github:${IMAGE_TAG:-stable}
    container_name: agent-github-incident-engineer-slim
    env_file:
    - ../.env
    ports:
    - 8002:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-github
    - MCP_PORT=8000
    depends_on:
    - slim-dataplane
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    profiles:
    - a2a-over-slim
  agent-backstage-incident-engineer-slim:
    image: ghcr.io/cnoe-io/agent-backstage:${IMAGE_TAG:-stable}
    container_name: agent-backstage-incident-engineer-slim
    env_file:
    - ../.env
    ports:
    - 8003:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-backstage
    - MCP_PORT=8000
    depends_on:
    - mcp-backstage
    - slim-dataplane
    profiles:
    - a2a-over-slim
  agent-jira-incident-engineer-slim:
    image: ghcr.io/cnoe-io/agent-jira:${IMAGE_TAG:-stable}
    container_name: agent-jira-incident-engineer-slim
    env_file:
    - ../.env
    ports:
    - 8004:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-jira
    - MCP_PORT=8000
    depends_on:
    - mcp-jira
    - slim-dataplane
    profiles:
    - a2a-over-slim
  agent-confluence-incident-engineer-slim:
    image: ghcr.io/cnoe-io/agent-confluence:${IMAGE_TAG:-stable}
    container_name: agent-confluence-incident-engineer-slim
    env_file:
    - ../.env
    ports:
    - 8005:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-confluence
    - MCP_PORT=8000
    depends_on:
    - mcp-confluence
    - slim-dataplane
    profiles:
    - a2a-over-slim
  agent-komodor-incident-engineer-slim:
    image: ghcr.io/cnoe-io/agent-komodor:${IMAGE_TAG:-stable}
    container_name: agent-komodor-incident-engineer-slim
    env_file:
    - ../.env
    ports:
    - 8006:8000
    environment:
    - A2A_TRANSPORT=slim
    - MCP_MODE=http
    - MCP_HOST=mcp-komodor
    - MCP_PORT=8000
    depends_on:
    - mcp-komodor
    - slim-dataplane
    profiles:
    - a2a-over-slim
  slim-dataplane:
    image: ghcr.io/agntcy/slim:0.3.15
    container_name: slim-dataplane
    profiles:
    - a2a-over-slim
    ports:
    - 46357:46357
    environment:
    - PASSWORD=${SLIM_GATEWAY_PASSWORD:-dummy_password}
    - CONFIG_PATH=/config.yaml
    volumes:
    - ../slim-config.yaml:/config.yaml
    command:
    - /slim
    - --config
    - /config.yaml
  slim-control-plane:
    image: ghcr.io/agntcy/slim/control-plane:0.0.1
    container_name: slim-control-plane
    profiles:
    - a2a-over-slim
    ports:
    - 50051:50051
    - 50052:50052
    environment:
    - PASSWORD=${SLIM_GATEWAY_PASSWORD:-dummy_password}
    - CONFIG_PATH=/config.yaml
    volumes:
    - ../slim-config.yaml:/config.yaml
    command:
    - /slim
    - --config
    - /config.yaml
